@page "/CreateAccount"

<div class="ca-container">
    <a class="ca-back" href="/Account" aria-label="Back">
        <span class="ca-back-icon">‹</span>
    </a>

    <h1 class="ca-title">Create an Account</h1>
    <p class="ca-sub">Please enter your personal information</p>

    <p class="ca-section">Personal Information</p>

    <form id="createAccountForm" onsubmit="return validateForm()">

        <div class="ca-field">
            <input class="ca-input" type="email" placeholder="@@gmail.com" required />
        </div>

        <div class="ca-row">
            <div class="ca-col">
                <input class="ca-input" type="text" placeholder="First Name" required />
            </div>

            <div class="ca-col ca-col-suffix">
                <select class="ca-input ca-select">
                    <option value="">Suffix</option>
                    <option>Jr.</option>
                    <option>Sr.</option>
                    <option>III</option>
                </select>
            </div>
        </div>

        <div class="ca-field">
            <input class="ca-input" type="text" placeholder="Middle Name" id="middleName" required />
        </div>

        <label class="ca-checkline">
            <input type="checkbox" id="noMiddleName" onchange="toggleMiddleName()" />
            <span class="ca-checklabel">I have no middle name</span>
        </label>

        <div class="ca-field">
            <input class="ca-input" type="text" placeholder="Last Name" required />
        </div>

        <div class="ca-field">
            <input class="ca-input" type="text" placeholder="MM/DD/YYYY" onfocus="this.type='date'" required />
        </div>

        <div class="ca-field">
            <input class="ca-input" type="text" placeholder="Home Address" required />
        </div>

        <!--Gender selection-->
        <div class="ca-gender">
            <label class="ca-gender-item">
                <input type="radio" name="gender" value="male" id="genderMale" required onclick="toggleRadio(this)" />
                <span class="ca-radio"></span>
                <span class="ca-gender-icon">♂</span>
                <span class="ca-gender-text">Male</span>
            </label>

            <label class="ca-gender-item">
                <input type="radio" name="gender" value="female" id="genderFemale" required onclick="toggleRadio(this)" />
                <span class="ca-radio"></span>
                <span class="ca-gender-icon">♀</span>
                <span class="ca-gender-text">Female</span>
            </label>
        </div>

        <label class="ca-checkline">
            <input type="checkbox" id="preferNotSay" onchange="toggleGender()" />
            <span class="ca-checklabel">I prefer not to say</span>
        </label>


        <!-- Password with Show/Hide -->
        <div class="ca-field ca-password">
            <input id="create-password" class="ca-input" type="password" placeholder="Password" required />
            <span class="toggle-password" onclick="togglePassword('create-password', this)">Show</span>
        </div>

        <!-- Confirm Password with Show/Hide -->
        <div class="ca-field ca-password">
            <input id="confirm-password" class="ca-input" type="password" placeholder="Confirm Password" required />
            <span class="toggle-password" onclick="togglePassword('confirm-password', this)">Show</span>
        </div>

        <!-- Agree to Terms -->
        <label class="ca-checkline ca-terms">
            <input type="checkbox" id="agreeTerms" required />
            <span class="ca-checklabel">
                I have read and agree to the
                <a href="/TermsConditions" class="ca-link">Terms and Conditions</a> and
                <a href="/PrivacyPolicy" class="ca-link">Privacy Policy</a>.
            </span>
        </label>

        <!-- Next Button -->
        <div class="ca-next">
            <button type="submit" class="ca-btn">Next</button>
        </div>

        <!-- Sign in button-->
        <div class="ca-signin">
            <p class="ca-signin-text">Already have an account?</p>
            <button type="button" class="ca-btn ca-btn-secondary" onclick="location.href='/SignIn'">
                Sign In
            </button>
        </div>

    </form>
</div>

<script>
    // Toggle password visibility
    function togglePassword(id, el) {
        const pwd = document.getElementById(id);
        if (pwd.type === "password") {
            pwd.type = "text";
            el.textContent = "Hide";
        } else {
            pwd.type = "password";
            el.textContent = "Show";
        }
    }

    // Disable/Enable Middle Name when “No Middle Name” is checked
    function toggleMiddleName() {
        const middleName = document.getElementById("middleName");
        const checkbox = document.getElementById("noMiddleName");
        if (checkbox.checked) {
            middleName.value = "";
            middleName.disabled = true;
            middleName.removeAttribute("required");
        } else {
            middleName.disabled = false;
            middleName.setAttribute("required", "true");
        }
    }

    
    // Allow "I prefer not to say" to disable gender radios
    function toggleGender() {
        const male = document.getElementById("genderMale");
        const female = document.getElementById("genderFemale");
        const prefer = document.getElementById("preferNotSay");

        if (prefer.checked) {
            male.checked = false;
            female.checked = false;
            male.disabled = true;
            female.disabled = true;
            male.removeAttribute("required");
            female.removeAttribute("required");
        } else {
            male.disabled = false;
            female.disabled = false;
            male.setAttribute("required", "true");
            female.setAttribute("required", "true");
        }
    }

    // Allow user to "unselect" a radio option by clicking again
    let lastChecked = null;
    function toggleRadio(el) {
        if (lastChecked === el) {
            el.checked = false;
            lastChecked = null;
        } else {
            lastChecked = el;
        }
    }

    // Validate before submitting
    function validateForm() {
        const form = document.getElementById("createAccountForm");
        const agreeTerms = document.getElementById("agreeTerms");
        const password = document.getElementById("create-password").value;
        const confirmPassword = document.getElementById("confirm-password").value;

        if (!agreeTerms.checked) {
            alert("Please agree to the Terms and Conditions and Privacy Policy before proceeding.");
            return false;
        }

        if (password !== confirmPassword) {
            alert("Passwords do not match!");
            return false;
        }

        if (!form.checkValidity()) {
            alert("Please complete all required fields.");
            return false;
        }

        // All good, proceed
        location.href = "/VerifyAccount";
        return false; // Prevent actual form submission for this demo
    }
</script>
